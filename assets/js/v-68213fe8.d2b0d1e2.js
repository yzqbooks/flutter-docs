"use strict";(self.webpackChunkflutter_docs=self.webpackChunkflutter_docs||[]).push([[1018],{22570:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t=JSON.parse('{"key":"v-68213fe8","path":"/chapter3/input_and_form.html","title":"3.5 输入框及表单","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"3.5.1 TextField","slug":"_3-5-1-textfield","link":"#_3-5-1-textfield","children":[]},{"level":2,"title":"3.5.2 表单Form","slug":"_3-5-2-表单form","link":"#_3-5-2-表单form","children":[]}],"git":{"createdTime":1654491188000,"updatedTime":1654491188000,"contributors":[{"name":"yzqdev","email":"yzqdev@outlook.com","commits":1}]},"readingTime":{"minutes":12.03,"words":3610},"filePathRelative":"chapter3/input_and_form.md","localizedDate":"2022年6月6日","excerpt":""}')},19043:(n,s,a)=>{a.r(s),a.d(s,{default:()=>r});var t=a(6808);const e=a.p+"assets/img/3-18.32004737.png",p=a.p+"assets/img/3-19.b4c99739.png",o=a.p+"assets/img/3-21.9b33d227.png",c=a.p+"assets/img/3-22.5f728cdb.png",l=a.p+"assets/img/3-23.e63c5380.png",i=a.p+"assets/img/3-24.0995708e.png",u=[(0,t.uE)('<h1 id="_3-5-输入框及表单" tabindex="-1"><a class="header-anchor" href="#_3-5-输入框及表单" aria-hidden="true">#</a> 3.5 输入框及表单</h1><p>Material 组件库中提供了输入框组件<code>TextField</code>和表单组件<code>Form</code>。下面我们分别介绍一下。</p><h2 id="_3-5-1-textfield" tabindex="-1"><a class="header-anchor" href="#_3-5-1-textfield" aria-hidden="true">#</a> 3.5.1 TextField</h2><p><code>TextField</code>用于文本输入，它提供了很多属性，我们先简单介绍一下主要属性的作用，然后通过几个示例来演示一下关键属性的用法。</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token keyword">const</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n  <span class="token class-name">TextEditingController</span> controller<span class="token punctuation">,</span> \n  <span class="token class-name">FocusNode</span> focusNode<span class="token punctuation">,</span>\n  <span class="token class-name">InputDecoration</span> decoration <span class="token operator">=</span> <span class="token keyword">const</span> <span class="token class-name">InputDecoration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token class-name">TextInputType</span> keyboardType<span class="token punctuation">,</span>\n  <span class="token class-name">TextInputAction</span> textInputAction<span class="token punctuation">,</span>\n  <span class="token class-name">TextStyle</span> style<span class="token punctuation">,</span>\n  <span class="token class-name">TextAlign</span> textAlign <span class="token operator">=</span> <span class="token class-name">TextAlign</span><span class="token punctuation">.</span>start<span class="token punctuation">,</span>\n  bool autofocus <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  bool obscureText <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  int maxLines <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>\n  int maxLength<span class="token punctuation">,</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>maxLengthEnforcement<span class="token punctuation">,</span>\n  <span class="token class-name">ToolbarOptions</span><span class="token operator">?</span> toolbarOptions<span class="token punctuation">,</span>\n  <span class="token class-name">ValueChanged</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> onChanged<span class="token punctuation">,</span>\n  <span class="token class-name">VoidCallback</span> onEditingComplete<span class="token punctuation">,</span>\n  <span class="token class-name">ValueChanged</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> onSubmitted<span class="token punctuation">,</span>\n  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TextInputFormatter</span><span class="token punctuation">&gt;</span></span> inputFormatters<span class="token punctuation">,</span>\n  bool enabled<span class="token punctuation">,</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>cursorWidth <span class="token operator">=</span> <span class="token number">2.0</span><span class="token punctuation">,</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>cursorRadius<span class="token punctuation">,</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>cursorColor<span class="token punctuation">,</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>onTap<span class="token punctuation">,</span>\n  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>controller</code>：编辑框的控制器，通过它可以设置/获取编辑框的内容、选择编辑内容、监听编辑文本改变事件。大多数情况下我们都需要显式提供一个<code>controller</code>来与文本框交互。如果没有提供<code>controller</code>，则<code>TextField</code>内部会自动创建一个。</p></li><li><p><code>focusNode</code>：用于控制<code>TextField</code>是否占有当前键盘的输入焦点。它是我们和键盘交互的一个句柄（handle）。</p></li><li><p><code>InputDecoration</code>：用于控制<code>TextField</code>的外观显示，如提示文本、背景颜色、边框等。</p></li><li><p><code>keyboardType</code>：用于设置该输入框默认的键盘输入类型，取值如下：</p><table><thead><tr><th>TextInputType枚举值</th><th>含义</th></tr></thead><tbody><tr><td>text</td><td>文本输入键盘</td></tr><tr><td>multiline</td><td>多行文本，需和maxLines配合使用(设为null或大于1)</td></tr><tr><td>number</td><td>数字；会弹出数字键盘</td></tr><tr><td>phone</td><td>优化后的电话号码输入键盘；会弹出数字键盘并显示“* #”</td></tr><tr><td>datetime</td><td>优化后的日期输入键盘；Android上会显示“: -”</td></tr><tr><td>emailAddress</td><td>优化后的电子邮件地址；会显示“@ .”</td></tr><tr><td>url</td><td>优化后的url输入键盘； 会显示“/ .”</td></tr></tbody></table></li><li><p><code>textInputAction</code>：键盘动作按钮图标(即回车键位图标)，它是一个枚举值，有多个可选值，全部的取值列表读者可以查看API文档，下面是当值为<code>TextInputAction.search</code>时，原生Android系统下键盘样式如图3-18所示：</p><p><img src="'+e+'" alt="图3-18"></p></li><li><p><code>style</code>：正在编辑的文本样式。</p></li><li><p><code>textAlign</code>: 输入框内编辑文本在水平方向的对齐方式。</p></li><li><p><code>autofocus</code>: 是否自动获取焦点。</p></li><li><p><code>obscureText</code>：是否隐藏正在编辑的文本，如用于输入密码的场景等，文本内容会用“•”替换。</p></li><li><p><code>maxLines</code>：输入框的最大行数，默认为1；如果为<code>null</code>，则无行数限制。</p></li><li><p><code>maxLength</code>和<code>maxLengthEnforcement</code> ：<code>maxLength</code>代表输入框文本的最大长度，设置后输入框右下角会显示输入的文本计数。<code>maxLengthEnforcement</code>决定当输入文本长度超过<code>maxLength</code>时如何处理，如截断、超出等。</p></li><li><p><code>toolbarOptions</code>：长按或鼠标右击时出现的菜单，包括 copy、cut、paste 以及 selectAll。</p></li><li><p><code>onChange</code>：输入框内容改变时的回调函数；注：内容改变事件也可以通过<code>controller</code>来监听。</p></li><li><p><code>onEditingComplete</code>和<code>onSubmitted</code>：这两个回调都是在输入框输入完成时触发，比如按了键盘的完成键（对号图标）或搜索键（🔍图标）。不同的是两个回调签名不同，<code>onSubmitted</code>回调是<code>ValueChanged&lt;String&gt;</code>类型，它接收当前输入内容做为参数，而<code>onEditingComplete</code>不接收参数。</p></li><li><p><code>inputFormatters</code>：用于指定输入格式；当用户输入内容改变时，会根据指定的格式来校验。</p></li><li><p><code>enable</code>：如果为<code>false</code>，则输入框会被禁用，禁用状态不接收输入和事件，同时显示禁用态样式（在其<code>decoration</code>中定义）。</p></li><li><p><code>cursorWidth</code>、<code>cursorRadius</code>和<code>cursorColor</code>：这三个属性是用于自定义输入框光标宽度、圆角和颜色的。</p></li></ul><h4 id="示例-登录输入框" tabindex="-1"><a class="header-anchor" href="#示例-登录输入框" aria-hidden="true">#</a> 示例：登录输入框</h4><h5 id="布局" tabindex="-1"><a class="header-anchor" href="#布局" aria-hidden="true">#</a> 布局</h5><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token class-name">Column</span><span class="token punctuation">(</span>\n  children<span class="token punctuation">:</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Widget</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span>\n    <span class="token class-name">TextField</span><span class="token punctuation">(</span>\n      autofocus<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n      decoration<span class="token punctuation">:</span> <span class="token class-name">InputDecoration</span><span class="token punctuation">(</span>\n        labelText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;用户名&quot;</span></span><span class="token punctuation">,</span>\n        hintText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;用户名或邮箱&quot;</span></span><span class="token punctuation">,</span>\n        prefixIcon<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>person<span class="token punctuation">)</span>\n      <span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token class-name">TextField</span><span class="token punctuation">(</span>\n      decoration<span class="token punctuation">:</span> <span class="token class-name">InputDecoration</span><span class="token punctuation">(</span>\n        labelText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;密码&quot;</span></span><span class="token punctuation">,</span>\n        hintText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;您的登录密码&quot;</span></span><span class="token punctuation">,</span>\n        prefixIcon<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>lock<span class="token punctuation">)</span>\n      <span class="token punctuation">)</span><span class="token punctuation">,</span>\n      obscureText<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行后，效果如图3-19所示：</p><p><img src="'+p+'" alt="图3-19"></p><h5 id="获取输入内容" tabindex="-1"><a class="header-anchor" href="#获取输入内容" aria-hidden="true">#</a> 获取输入内容</h5><p>获取输入内容有两种方式：</p><ol><li>定义两个变量，用于保存用户名和密码，然后在<code>onChange</code>触发时，各自保存一下输入内容。</li><li>通过<code>controller</code>直接获取。</li></ol><p>第一种方式比较简单，不在举例，我们来重点看一下第二种方式，我们以用户名输入框举例：</p><p>定义一个<code>controller</code>：</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token comment">//定义一个controller</span>\n<span class="token class-name">TextEditingController</span> _unameController <span class="token operator">=</span> <span class="token class-name">TextEditingController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>然后设置输入框controller：</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token class-name">TextField</span><span class="token punctuation">(</span>\n    autofocus<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    controller<span class="token punctuation">:</span> _unameController<span class="token punctuation">,</span> <span class="token comment">//设置controller</span>\n    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过controller获取输入框内容</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token function">print</span><span class="token punctuation">(</span>_unameController<span class="token punctuation">.</span>text<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="监听文本变化" tabindex="-1"><a class="header-anchor" href="#监听文本变化" aria-hidden="true">#</a> 监听文本变化</h5><p>监听文本变化也有两种方式：</p><ol><li><p>设置<code>onChange</code>回调，如：</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token class-name">TextField</span><span class="token punctuation">(</span>\n    autofocus<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    onChanged<span class="token punctuation">:</span> <span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;onChange: </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">v</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>通过<code>controller</code>监听，如：</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token metadata function">@override</span>\n<span class="token keyword">void</span> <span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">//监听输入改变  </span>\n  _unameController<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token function">print</span><span class="token punctuation">(</span>_unameController<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>两种方式相比，<code>onChanged</code>是专门用于监听文本变化，而<code>controller</code>的功能却多一些，除了能监听文本变化外，它还可以设置默认值、选择文本，下面我们看一个例子：</p><p>创建一个<code>controller</code>:</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token class-name">TextEditingController</span> _selectionController <span class="token operator">=</span>  <span class="token class-name">TextEditingController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>设置默认值，并从第三个字符开始选中后面的字符</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code>_selectionController<span class="token punctuation">.</span>text<span class="token operator">=</span><span class="token string-literal"><span class="token string">&quot;hello world!&quot;</span></span><span class="token punctuation">;</span>\n_selectionController<span class="token punctuation">.</span>selection<span class="token operator">=</span><span class="token class-name">TextSelection</span><span class="token punctuation">(</span>\n    baseOffset<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>\n    extentOffset<span class="token punctuation">:</span> _selectionController<span class="token punctuation">.</span>text<span class="token punctuation">.</span>length\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>设置<code>controlle</code>r:</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token class-name">TextField</span><span class="token punctuation">(</span>\n  controller<span class="token punctuation">:</span> _selectionController<span class="token punctuation">,</span>\n<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行效果如图3-20所示：</p><p><img src="data:image/png;base64,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" alt="图3-20"></p><h5 id="控制焦点" tabindex="-1"><a class="header-anchor" href="#控制焦点" aria-hidden="true">#</a> 控制焦点</h5><p>焦点可以通过<code>FocusNode</code>和<code>FocusScopeNode</code>来控制，默认情况下，焦点由<code>FocusScope</code>来管理，它代表焦点控制范围，可以在这个范围内可以通过<code>FocusScopeNode</code>在输入框之间移动焦点、设置默认焦点等。我们可以通过<code>FocusScope.of(context)</code> 来获取Widget树中默认的<code>FocusScopeNode</code>。下面看一个示例，在此示例中创建两个<code>TextField</code>，第一个自动获取焦点，然后创建两个按钮：</p><ul><li>点击第一个按钮可以将焦点从第一个<code>TextField</code>挪到第二个<code>TextField</code>。</li><li>点击第二个按钮可以关闭键盘。</li></ul><p>我们要实现的效果如图3-21所示：</p><p><img src="'+o+'" alt="图3-21"></p><p>代码如下：</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token keyword">class</span> <span class="token class-name">FocusTestRoute</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">{</span>\n  <span class="token metadata function">@override</span>\n  _FocusTestRouteState <span class="token function">createState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">_FocusTestRouteState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> _FocusTestRouteState <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FocusTestRoute</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>\n  <span class="token class-name">FocusNode</span> focusNode1 <span class="token operator">=</span> <span class="token class-name">FocusNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token class-name">FocusNode</span> focusNode2 <span class="token operator">=</span> <span class="token class-name">FocusNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token class-name">FocusScopeNode</span><span class="token operator">?</span> focusScopeNode<span class="token punctuation">;</span>\n\n  <span class="token metadata function">@override</span>\n  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token class-name">Padding</span><span class="token punctuation">(</span>\n      padding<span class="token punctuation">:</span> <span class="token class-name">EdgeInsets</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token number">16.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n      child<span class="token punctuation">:</span> <span class="token class-name">Column</span><span class="token punctuation">(</span>\n        children<span class="token punctuation">:</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Widget</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span>\n          <span class="token class-name">TextField</span><span class="token punctuation">(</span>\n            autofocus<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> \n            focusNode<span class="token punctuation">:</span> focusNode1<span class="token punctuation">,</span><span class="token comment">//关联focusNode1</span>\n            decoration<span class="token punctuation">:</span> <span class="token class-name">InputDecoration</span><span class="token punctuation">(</span>\n                labelText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;input1&quot;</span></span>\n            <span class="token punctuation">)</span><span class="token punctuation">,</span>\n          <span class="token punctuation">)</span><span class="token punctuation">,</span>\n          <span class="token class-name">TextField</span><span class="token punctuation">(</span>\n            focusNode<span class="token punctuation">:</span> focusNode2<span class="token punctuation">,</span><span class="token comment">//关联focusNode2</span>\n            decoration<span class="token punctuation">:</span> <span class="token class-name">InputDecoration</span><span class="token punctuation">(</span>\n                labelText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;input2&quot;</span></span>\n            <span class="token punctuation">)</span><span class="token punctuation">,</span>\n          <span class="token punctuation">)</span><span class="token punctuation">,</span>\n          <span class="token class-name">Builder</span><span class="token punctuation">(</span>builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">return</span> <span class="token class-name">Column</span><span class="token punctuation">(</span>\n              children<span class="token punctuation">:</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Widget</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span>\n                <span class="token class-name">ElevatedButton</span><span class="token punctuation">(</span>\n                  child<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;移动焦点&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n                  onPressed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                    <span class="token comment">//将焦点从第一个TextField移到第二个TextField</span>\n                    <span class="token comment">// 这是一种写法 FocusScope.of(context).requestFocus(focusNode2);</span>\n                    <span class="token comment">// 这是第二种写法</span>\n                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> focusScopeNode<span class="token punctuation">)</span><span class="token punctuation">{</span>\n                      focusScopeNode <span class="token operator">=</span> <span class="token class-name">FocusScope</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token punctuation">}</span>\n                    focusScopeNode<span class="token punctuation">.</span><span class="token function">requestFocus</span><span class="token punctuation">(</span>focusNode2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n                <span class="token punctuation">)</span><span class="token punctuation">,</span>\n                <span class="token class-name">ElevatedButton</span><span class="token punctuation">(</span>\n                  child<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;隐藏键盘&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n                  onPressed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                    <span class="token comment">// 当所有编辑框都失去焦点时键盘就会收起  </span>\n                    focusNode1<span class="token punctuation">.</span><span class="token function">unfocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    focusNode2<span class="token punctuation">.</span><span class="token function">unfocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n                <span class="token punctuation">)</span><span class="token punctuation">,</span>\n              <span class="token punctuation">]</span><span class="token punctuation">,</span>\n            <span class="token punctuation">)</span><span class="token punctuation">;</span>\n          <span class="token punctuation">}</span><span class="token punctuation">,</span>\n          <span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">]</span><span class="token punctuation">,</span>\n      <span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>FocusNode</code>和<code>FocusScopeNode</code>还有一些其它的方法，详情可以查看API文档。</p><h5 id="监听焦点状态改变事件" tabindex="-1"><a class="header-anchor" href="#监听焦点状态改变事件" aria-hidden="true">#</a> 监听焦点状态改变事件</h5><p><code>FocusNode</code>继承自<code>ChangeNotifier</code>，通过<code>FocusNode</code>可以监听焦点的改变事件，如：</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token comment">// 创建 focusNode   </span>\n<span class="token class-name">FocusNode</span> focusNode <span class="token operator">=</span> <span class="token class-name">FocusNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token comment">// focusNode绑定输入框   </span>\n<span class="token class-name">TextField</span><span class="token punctuation">(</span>focusNode<span class="token punctuation">:</span> focusNode<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token comment">// 监听焦点变化    </span>\nfocusNode<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n   <span class="token function">print</span><span class="token punctuation">(</span>focusNode<span class="token punctuation">.</span>hasFocus<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>获得焦点时<code>focusNode.hasFocus</code>值为<code>true</code>，失去焦点时为<code>false</code>。</p><h5 id="自定义样式" tabindex="-1"><a class="header-anchor" href="#自定义样式" aria-hidden="true">#</a> 自定义样式</h5><p>虽然我们可以通过<code>decoration</code>属性来定义输入框样式，下面以自定义输入框下划线颜色为例来介绍一下：</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token class-name">TextField</span><span class="token punctuation">(</span>\n  decoration<span class="token punctuation">:</span> <span class="token class-name">InputDecoration</span><span class="token punctuation">(</span>\n    labelText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;请输入用户名&quot;</span></span><span class="token punctuation">,</span>\n    prefixIcon<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>person<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token comment">// 未获得焦点下划线设为灰色</span>\n    enabledBorder<span class="token punctuation">:</span> <span class="token class-name">UnderlineInputBorder</span><span class="token punctuation">(</span>\n      borderSide<span class="token punctuation">:</span> <span class="token class-name">BorderSide</span><span class="token punctuation">(</span>color<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>grey<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token comment">//获得焦点下划线设为蓝色</span>\n    focusedBorder<span class="token punctuation">:</span> <span class="token class-name">UnderlineInputBorder</span><span class="token punctuation">(</span>\n      borderSide<span class="token punctuation">:</span> <span class="token class-name">BorderSide</span><span class="token punctuation">(</span>color<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>blue<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">)</span><span class="token punctuation">,</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码我们直接通过InputDecoration的enabledBorder和focusedBorder来分别设置了输入框在未获取焦点和获得焦点后的下划线颜色。另外，我们也可以通过主题来自定义输入框的样式，下面我们探索一下如何在不使用enabledBorder和focusedBorder的情况下来自定义下滑线颜色。</p><p>由于<code>TextField</code>在绘制下划线时使用的颜色是主题色里面的<code>hintColor</code>，但提示文本颜色也是用的<code>hintColor</code>， 如果我们直接修改<code>hintColor</code>，那么下划线和提示文本的颜色都会变。值得高兴的是<code>decoration</code>中可以设置<code>hintStyle</code>，它可以覆盖<code>hintColor</code>，并且主题中可以通过<code>inputDecorationTheme</code>来设置输入框默认的<code>decoration</code>。所以我们可以通过主题来自定义，代码如下：</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token class-name">Theme</span><span class="token punctuation">(</span>\n  data<span class="token punctuation">:</span> <span class="token class-name">Theme</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">copyWith</span><span class="token punctuation">(</span>\n      hintColor<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>grey<span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//定义下划线颜色</span>\n      inputDecorationTheme<span class="token punctuation">:</span> <span class="token class-name">InputDecorationTheme</span><span class="token punctuation">(</span>\n          labelStyle<span class="token punctuation">:</span> <span class="token class-name">TextStyle</span><span class="token punctuation">(</span>color<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>grey<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//定义label字体样式</span>\n          hintStyle<span class="token punctuation">:</span> <span class="token class-name">TextStyle</span><span class="token punctuation">(</span>color<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>grey<span class="token punctuation">,</span> fontSize<span class="token punctuation">:</span> <span class="token number">14.0</span><span class="token punctuation">)</span><span class="token comment">//定义提示文本样式</span>\n      <span class="token punctuation">)</span>\n  <span class="token punctuation">)</span><span class="token punctuation">,</span>\n  child<span class="token punctuation">:</span> <span class="token class-name">Column</span><span class="token punctuation">(</span>\n    children<span class="token punctuation">:</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Widget</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span>\n      <span class="token class-name">TextField</span><span class="token punctuation">(</span>\n        decoration<span class="token punctuation">:</span> <span class="token class-name">InputDecoration</span><span class="token punctuation">(</span>\n            labelText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;用户名&quot;</span></span><span class="token punctuation">,</span>\n            hintText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;用户名或邮箱&quot;</span></span><span class="token punctuation">,</span>\n            prefixIcon<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>person<span class="token punctuation">)</span>\n        <span class="token punctuation">)</span><span class="token punctuation">,</span>\n      <span class="token punctuation">)</span><span class="token punctuation">,</span>\n      <span class="token class-name">TextField</span><span class="token punctuation">(</span>\n        decoration<span class="token punctuation">:</span> <span class="token class-name">InputDecoration</span><span class="token punctuation">(</span>\n            prefixIcon<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>lock<span class="token punctuation">)</span><span class="token punctuation">,</span>\n            labelText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;密码&quot;</span></span><span class="token punctuation">,</span>\n            hintText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;您的登录密码&quot;</span></span><span class="token punctuation">,</span>\n            hintStyle<span class="token punctuation">:</span> <span class="token class-name">TextStyle</span><span class="token punctuation">(</span>color<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>grey<span class="token punctuation">,</span> fontSize<span class="token punctuation">:</span> <span class="token number">13.0</span><span class="token punctuation">)</span>\n        <span class="token punctuation">)</span><span class="token punctuation">,</span>\n        obscureText<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n      <span class="token punctuation">)</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">)</span>\n<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行效果如图3-22所示：</p><p><img src="'+c+'" alt="图3-22"></p><p>我们成功的自定义了下划线颜色和提问文字样式，细心的读者可能已经发现，通过这种方式自定义后，输入框在获取焦点时，<code>labelText</code>不会高亮显示了，正如上图中的&quot;用户名&quot;本应该显示蓝色，但现在却显示为灰色，并且我们还是无法定义下划线宽度。另一种灵活的方式是直接隐藏掉<code>TextField</code>本身的下划线，然后通过<code>Container</code>去嵌套定义样式，如:</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token class-name">Container</span><span class="token punctuation">(</span>\n  child<span class="token punctuation">:</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span>\n    keyboardType<span class="token punctuation">:</span> <span class="token class-name">TextInputType</span><span class="token punctuation">.</span>emailAddress<span class="token punctuation">,</span>\n    decoration<span class="token punctuation">:</span> <span class="token class-name">InputDecoration</span><span class="token punctuation">(</span>\n        labelText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Email&quot;</span></span><span class="token punctuation">,</span>\n        hintText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;电子邮件地址&quot;</span></span><span class="token punctuation">,</span>\n        prefixIcon<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>email<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        border<span class="token punctuation">:</span> <span class="token class-name">InputBorder</span><span class="token punctuation">.</span>none <span class="token comment">//隐藏下划线</span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">)</span><span class="token punctuation">,</span>\n  decoration<span class="token punctuation">:</span> <span class="token class-name">BoxDecoration</span><span class="token punctuation">(</span>\n      <span class="token comment">// 下滑线浅灰色，宽度1像素</span>\n      border<span class="token punctuation">:</span> <span class="token class-name">Border</span><span class="token punctuation">(</span>bottom<span class="token punctuation">:</span> <span class="token class-name">BorderSide</span><span class="token punctuation">(</span>color<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>grey<span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span> width<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n  <span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行效果如图3-23：</p><p><img src="'+l+'" alt="3-23"></p><p>通过这种组件组合的方式，也可以定义背景圆角等。一般来说，优先通过<code>decoration</code>来自定义样式，如果<code>decoration</code>实现不了，再用widget组合的方式。</p><blockquote><p>思考题：在这个示例中，下划线颜色是固定的，所以获得焦点后颜色仍然为灰色，如何实现点击后下滑线也变色呢？</p></blockquote><h2 id="_3-5-2-表单form" tabindex="-1"><a class="header-anchor" href="#_3-5-2-表单form" aria-hidden="true">#</a> 3.5.2 表单Form</h2><p>实际业务中，在正式向服务器提交数据前，都会对各个输入框数据进行合法性校验，但是对每一个<code>TextField</code>都分别进行校验将会是一件很麻烦的事。还有，如果用户想清除一组<code>TextField</code>的内容，除了一个一个清除有没有什么更好的办法呢？为此，Flutter提供了一个<code>Form</code> 组件，它可以对输入框进行分组，然后进行一些统一操作，如输入内容校验、输入框重置以及输入内容保存。</p><h4 id="form" tabindex="-1"><a class="header-anchor" href="#form" aria-hidden="true">#</a> Form</h4><p><code>Form</code>继承自<code>StatefulWidget</code>对象，它对应的状态类为<code>FormState</code>。我们先看看<code>Form</code>类的定义：</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token class-name">Form</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  required <span class="token class-name">Widget</span> child<span class="token punctuation">,</span>\n  bool autovalidate <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  <span class="token class-name">WillPopCallback</span> onWillPop<span class="token punctuation">,</span>\n  <span class="token class-name">VoidCallback</span> onChanged<span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>autovalidate</code>：是否自动校验输入内容；当为<code>true</code>时，每一个子 FormField 内容发生变化时都会自动校验合法性，并直接显示错误信息。否则，需要通过调用<code>FormState.validate()</code>来手动校验。</li><li><code>onWillPop</code>：决定<code>Form</code>所在的路由是否可以直接返回（如点击返回按钮），该回调返回一个<code>Future</code>对象，如果 Future 的最终结果是<code>false</code>，则当前路由不会返回；如果为<code>true</code>，则会返回到上一个路由。此属性通常用于拦截返回按钮。</li><li><code>onChanged</code>：<code>Form</code>的任意一个子<code>FormField</code>内容发生变化时会触发此回调。</li></ul><h4 id="formfield" tabindex="-1"><a class="header-anchor" href="#formfield" aria-hidden="true">#</a> FormField</h4><p><code>Form</code>的子孙元素必须是<code>FormField</code>类型，<code>FormField</code>是一个抽象类，定义几个属性，<code>FormState</code>内部通过它们来完成操作，<code>FormField</code>部分定义如下：</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token keyword">const</span> <span class="token class-name">FormField</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n  <span class="token class-name">FormFieldSetter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> onSaved<span class="token punctuation">,</span> <span class="token comment">//保存回调</span>\n  <span class="token class-name">FormFieldValidator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span>  validator<span class="token punctuation">,</span> <span class="token comment">//验证回调</span>\n  <span class="token class-name">T</span> initialValue<span class="token punctuation">,</span> <span class="token comment">//初始值</span>\n  bool autovalidate <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//是否自动校验。</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>为了方便使用，Flutter 提供了一个<code>TextFormField</code>组件，它继承自<code>FormField</code>类，也是<code>TextField</code>的一个包装类，所以除了<code>FormField</code>定义的属性之外，它还包括<code>TextField</code>的属性。</p><h4 id="formstate" tabindex="-1"><a class="header-anchor" href="#formstate" aria-hidden="true">#</a> FormState</h4><p><code>FormState</code>为<code>Form</code>的<code>State</code>类，可以通过<code>Form.of()</code>或<code>GlobalKey</code>获得。我们可以通过它来对<code>Form</code>的子孙<code>FormField</code>进行统一操作。我们看看其常用的三个方法：</p><ul><li><code>FormState.validate()</code>：调用此方法后，会调用<code>Form</code>子孙<code>FormField的validate</code>回调，如果有一个校验失败，则返回false，所有校验失败项都会返回用户返回的错误提示。</li><li><code>FormState.save()</code>：调用此方法后，会调用<code>Form</code>子孙<code>FormField</code>的<code>save</code>回调，用于保存表单内容</li><li><code>FormState.reset()</code>：调用此方法后，会将子孙<code>FormField</code>的内容清空。</li></ul><h4 id="示例" tabindex="-1"><a class="header-anchor" href="#示例" aria-hidden="true">#</a> 示例</h4><p>我们修改一下上面用户登录的示例，在提交之前校验：</p><ol><li>用户名不能为空，如果为空则提示“用户名不能为空”。</li><li>密码不能小于 6 位，如果小于 6 为则提示“密码不能少于 6 位”。</li></ol><p>完整代码：</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flutter/material.dart&#39;</span></span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">FormTestRoute</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">{</span>\n  <span class="token metadata function">@override</span>\n  _FormTestRouteState <span class="token function">createState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">_FormTestRouteState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> _FormTestRouteState <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FormTestRoute</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>\n  <span class="token class-name">TextEditingController</span> _unameController <span class="token operator">=</span> <span class="token class-name">TextEditingController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token class-name">TextEditingController</span> _pwdController <span class="token operator">=</span> <span class="token class-name">TextEditingController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token class-name">GlobalKey</span> _formKey <span class="token operator">=</span> <span class="token class-name">GlobalKey</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FormState</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token metadata function">@override</span>\n  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token class-name">Form</span><span class="token punctuation">(</span>\n      key<span class="token punctuation">:</span> _formKey<span class="token punctuation">,</span> <span class="token comment">//设置globalKey，用于后面获取FormState</span>\n      autovalidateMode<span class="token punctuation">:</span> <span class="token class-name">AutovalidateMode</span><span class="token punctuation">.</span>onUserInteraction<span class="token punctuation">,</span>\n      child<span class="token punctuation">:</span> <span class="token class-name">Column</span><span class="token punctuation">(</span>\n        children<span class="token punctuation">:</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Widget</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span>\n          <span class="token class-name">TextFormField</span><span class="token punctuation">(</span>\n            autofocus<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n            controller<span class="token punctuation">:</span> _unameController<span class="token punctuation">,</span>\n            decoration<span class="token punctuation">:</span> <span class="token class-name">InputDecoration</span><span class="token punctuation">(</span>\n              labelText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;用户名&quot;</span></span><span class="token punctuation">,</span>\n              hintText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;用户名或邮箱&quot;</span></span><span class="token punctuation">,</span>\n              icon<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>person<span class="token punctuation">)</span><span class="token punctuation">,</span>\n            <span class="token punctuation">)</span><span class="token punctuation">,</span>\n            <span class="token comment">// 校验用户名</span>\n            validator<span class="token punctuation">:</span> <span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n              <span class="token keyword">return</span> v<span class="token operator">!</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isNotEmpty <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;用户名不能为空&quot;</span></span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span><span class="token punctuation">,</span>\n          <span class="token punctuation">)</span><span class="token punctuation">,</span>\n          <span class="token class-name">TextFormField</span><span class="token punctuation">(</span>\n            controller<span class="token punctuation">:</span> _pwdController<span class="token punctuation">,</span>\n            decoration<span class="token punctuation">:</span> <span class="token class-name">InputDecoration</span><span class="token punctuation">(</span>\n              labelText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;密码&quot;</span></span><span class="token punctuation">,</span>\n              hintText<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;您的登录密码&quot;</span></span><span class="token punctuation">,</span>\n              icon<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>lock<span class="token punctuation">)</span><span class="token punctuation">,</span>\n            <span class="token punctuation">)</span><span class="token punctuation">,</span>\n            obscureText<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n            <span class="token comment">//校验密码</span>\n            validator<span class="token punctuation">:</span> <span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n              <span class="token keyword">return</span> v<span class="token operator">!</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">5</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;密码不能少于6位&quot;</span></span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span><span class="token punctuation">,</span>\n          <span class="token punctuation">)</span><span class="token punctuation">,</span>\n          <span class="token comment">// 登录按钮</span>\n          <span class="token class-name">Padding</span><span class="token punctuation">(</span>\n            padding<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">EdgeInsets</span><span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span>top<span class="token punctuation">:</span> <span class="token number">28.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n            child<span class="token punctuation">:</span> <span class="token class-name">Row</span><span class="token punctuation">(</span>\n              children<span class="token punctuation">:</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Widget</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span>\n                <span class="token class-name">Expanded</span><span class="token punctuation">(</span>\n                  child<span class="token punctuation">:</span> <span class="token class-name">ElevatedButton</span><span class="token punctuation">(</span>\n                    child<span class="token punctuation">:</span> <span class="token class-name">Padding</span><span class="token punctuation">(</span>\n                      padding<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">EdgeInsets</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token number">16.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n                      child<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;登录&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n                    <span class="token punctuation">)</span><span class="token punctuation">,</span>\n                    onPressed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                      <span class="token comment">// 通过_formKey.currentState 获取FormState后，</span>\n                      <span class="token comment">// 调用validate()方法校验用户名密码是否合法，校验</span>\n                      <span class="token comment">// 通过后再提交数据。</span>\n                      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>_formKey<span class="token punctuation">.</span>currentState <span class="token operator">as</span> <span class="token class-name">FormState</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                        <span class="token comment">//验证通过提交数据</span>\n                      <span class="token punctuation">}</span>\n                    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n                  <span class="token punctuation">)</span><span class="token punctuation">,</span>\n                <span class="token punctuation">)</span><span class="token punctuation">,</span>\n              <span class="token punctuation">]</span><span class="token punctuation">,</span>\n            <span class="token punctuation">)</span><span class="token punctuation">,</span>\n          <span class="token punctuation">)</span>\n        <span class="token punctuation">]</span><span class="token punctuation">,</span>\n      <span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行后效果如图3-24所示：</p><p><img src="'+i+'" alt="图3-24"></p><p>注意，登录按钮的<code>onPressed</code>方法中不能通过<code>Form.of(context)</code>来获取<code>FormState</code>，原因是，此处的<code>context</code>为<code>FormTestRoute</code>的context，而<code>Form.of(context)</code>是根据所指定<code>context</code>向根去查找，而<code>FormState</code>是在<code>FormTestRoute</code>的子树中，所以不行。正确的做法是通过<code>Builder</code>来构建登录按钮，<code>Builder</code>会将<code>widget</code>节点的<code>context</code>作为回调参数：</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token class-name">Expanded</span><span class="token punctuation">(</span>\n <span class="token comment">// 通过Builder来获取ElevatedButton所在widget树的真正context(Element) </span>\n  child<span class="token punctuation">:</span><span class="token class-name">Builder</span><span class="token punctuation">(</span>builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token class-name">ElevatedButton</span><span class="token punctuation">(</span>\n      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n      onPressed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">//由于本widget也是Form的子代widget，所以可以通过下面方式获取FormState  </span>\n        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Form</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n          <span class="token comment">//验证通过提交数据</span>\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其实<code>context</code>正是操作Widget所对应的<code>Element</code>的一个接口，由于Widget树对应的<code>Element</code>都是不同的，所以<code>context</code>也都是不同的，有关<code>context</code>的更多内容会在后面高级部分详细讨论。Flutter中有很多“of(context)”这种方法，读者在使用时一定要注意<code>context</code>是否正确。</p>',82)],d={},r=(0,a(18580).Z)(d,[["render",function(n,s){return(0,t.wg)(),(0,t.iD)("div",null,u)}]])},18580:(n,s)=>{s.Z=(n,s)=>{const a=n.__vccOpts||n;for(const[n,t]of s)a[n]=t;return a}}}]);